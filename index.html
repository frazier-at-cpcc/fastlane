<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fast Lane AI Training Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @font-face {
            font-family: 'URWGothic';
            src: url('fonts/URWGothic-Book.WOFF') format('woff');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'URWGothic';
            src: url('fonts/URWGothic-BookOblique.WOFF') format('woff');
            font-weight: normal;
            font-style: italic;
        }
        @font-face {
            font-family: 'URWGothic';
            src: url('fonts/URWGothic-Demi.WOFF') format('woff');
            font-weight: bold;
            font-style: normal;
        }
        @font-face {
            font-family: 'URWGothic';
            src: url('fonts/URWGothic-DemiOblique.WOFF') format('woff');
            font-weight: bold;
            font-style: italic;
        }
        body {
            font-family: 'URWGothic', sans-serif;
        }
        .markdown-content h1, .markdown-content h2 { margin-top: 1em; margin-bottom: 0.5em; font-weight: bold; }
        .markdown-content h1 { font-size: 1.5em; }
        .markdown-content h2 { font-size: 1.3em; }
        .markdown-content ul, .markdown-content ol { margin-left: 1.5em; margin-bottom: 1em; }
        .markdown-content li { margin-bottom: 0.5em; }
        .markdown-content p { margin-bottom: 1em; }
        @media print {
            body * {
                visibility: hidden;
            }
            #survey-container, #survey-container * {
                visibility: visible;
            }
            #survey-container {
                position: absolute;
                left: 0;
                top: 0;
            }
            #print-btn, #done-btn {
                display: none;
            }
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="survey-container" class="max-w-md mx-auto mt-10 bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
        <img src="logo.png" alt="Logo" class="mb-4 mx-auto" style="max-height: 100px;">
        <h1 class="text-2xl font-bold mb-4">Fast Lane AI Training Needs Assessment</h1>
        <div id="progress-bar" class="w-full bg-gray-200 rounded-full h-2.5 mb-4 hidden">
            <div id="progress" class="bg-red-600 h-2.5 rounded-full" style="width: 0%"></div>
        </div>
        <div id="customer-info" class="mb-6">
            <h2 class="text-xl font-semibold mb-4">Customer Information</h2>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="name">
                    Name
                </label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="name" type="text" placeholder="Your Name">
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="company">
                    Company
                </label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="company" type="text" placeholder="Your Company">
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="email">
                    Email
                </label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="email" type="email" placeholder="Your Email">
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="phone">
                    Phone
                </label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="phone" type="tel" placeholder="Your Phone Number">
            </div>
        </div>
        <div id="question-container"></div>
        <button id="next-btn" class="mt-4 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Next</button>
        <button id="done-btn" class="mt-4 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded hidden">I'm Done</button>
        <button id="print-btn" class="mt-4 ml-4 bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded hidden">Print</button>
    </div>

    <script>
        const questions = [
            {
                id: 'role',
                text: 'What is your primary role?',
                type: 'radio',
                options: ['Business Leader/Stakeholder', 'Developer', 'Data Analyst', 'Machine Learning Engineer', 'Data Scientist', 'Data Engineer', 'AI/GenAI Specialist', 'Cybersecurity Professional', 'Other']
            },
            {
                id: 'aiKnowledge',
                text: 'What is your current level of AI knowledge?',
                type: 'radio',
                options: ['Beginner (little to no knowledge)', 'Intermediate (some understanding and experience)', 'Advanced (extensive knowledge and experience)']
            },
            {
                id: 'cloudPlatforms',
                text: 'Which cloud platform(s) are you most interested in or currently using?',
                type: 'checkbox',
                options: ['Google Cloud', 'Microsoft Azure', 'AWS', 'Not specific to any cloud platform', 'Other']
            },
            {
                id: 'goals',
                text: 'What are your primary goals for AI training?',
                type: 'checkbox',
                options: ['Understanding AI fundamentals', 'Developing AI applications', 'Implementing AI in business operations', 'Data analysis and visualization', 'Machine learning and deep learning', 'Natural Language Processing (NLP)', 'Computer Vision', 'AI security and ethics', 'AI project management', 'Other']
            },
            {
                id: 'languages',
                text: 'Which programming languages are you most comfortable with or interested in learning?',
                type: 'checkbox',
                options: ['Python', 'R', 'Java', 'Scala', 'No programming experience', 'Other']
            },
            {
                id: 'technologies',
                text: 'Are you interested in any specific AI technologies or frameworks?',
                type: 'yesno',
                followUpType: 'checkbox',
                options: ['TensorFlow', 'PyTorch', 'Scikit-learn', 'OpenAI (e.g., GPT models)', 'Dialogflow', 'Vertex AI', 'Azure Cognitive Services', 'Other']
            },
            {
                id: 'industry',
                text: 'What industry sector do you work in?',
                type: 'radio',
                options: ['Technology', 'Finance', 'Healthcare', 'Education', 'Manufacturing', 'Retail', 'Government', 'Other']
            },
            {
                id: 'time',
                text: 'How much time can you dedicate to AI training?',
                type: 'radio',
                options: ['A few hours per week', '1-2 full days', '3-5 full days', 'More than a week']
            },
            {
                id: 'applications',
                text: 'Are you interested in any specific AI applications?',
                type: 'yesno',
                followUpType: 'checkbox',
                options: ['Chatbots and conversational AI', 'Predictive analytics', 'Recommendation systems', 'Anomaly detection', 'Image and video analysis', 'Text analysis and generation', 'Robotic Process Automation (RPA)', 'Other']
            },
            {
                id: 'challenges',
                text: 'Are there any specific challenges or use cases you\'re looking to address with AI in your organization?',
                type: 'yesno',
                followUpType: 'text'
            }
        ];

        let currentQuestion = -1;
        const answers = {};

        const questionContainer = document.getElementById('question-container');
        const nextButton = document.getElementById('next-btn');
        const doneButton = document.getElementById('done-btn');
        const printButton = document.getElementById('print-btn');
        const customerInfoDiv = document.getElementById('customer-info');
        const progressBar = document.getElementById('progress-bar');
        const progress = document.getElementById('progress');

        function renderQuestion(question) {
            questionContainer.innerHTML = `
                <h2 class="text-xl font-semibold mb-4">${question.text}</h2>
                ${getQuestionHTML(question)}
            `;

            if (question.type === 'radio' || question.type === 'checkbox') {
                const options = questionContainer.querySelectorAll('input[type="radio"], input[type="checkbox"]');
                options.forEach(option => {
                    option.addEventListener('change', () => {
                        if (option.value === 'Other') {
                            const otherInput = questionContainer.querySelector(`#${question.id}-other`);
                            otherInput.style.display = option.checked ? 'block' : 'none';
                        }
                        updateNextButtonState();
                    });
                });
            } else if (question.type === 'yesno') {
                const yesNoOptions = questionContainer.querySelectorAll('input[type="radio"]');
                yesNoOptions.forEach(option => {
                    option.addEventListener('change', () => {
                        const followUpContainer = questionContainer.querySelector('#follow-up-container');
                        followUpContainer.style.display = option.value === 'Yes' ? 'block' : 'none';
                        updateNextButtonState();
                    });
                });

                if (question.followUpType === 'checkbox') {
                    const checkboxOptions = questionContainer.querySelectorAll('input[type="checkbox"]');
                    checkboxOptions.forEach(option => {
                        option.addEventListener('change', () => {
                            if (option.value === 'Other') {
                                const otherInput = questionContainer.querySelector(`#${question.id}-other`);
                                otherInput.style.display = option.checked ? 'block' : 'none';
                            }
                            updateNextButtonState();
                        });
                    });
                } else if (question.followUpType === 'text') {
                    const textArea = questionContainer.querySelector('textarea');
                    if (textArea) {
                        textArea.addEventListener('input', updateNextButtonState);
                    }
                }
            }

            if (question.type === 'text') {
                const textArea = questionContainer.querySelector('textarea');
                textArea.addEventListener('input', updateNextButtonState);
            }

            updateNextButtonState();
            updateProgressBar();
        }

        function getQuestionHTML(question) {
            switch (question.type) {
                case 'radio':
                    return question.options.map(option => `
                        <div class="mb-2">
                            <label class="inline-flex items-center">
                                <input type="radio" name="${question.id}" value="${option}" class="form-radio">
                                <span class="ml-2">${option}</span>
                            </label>
                            ${option === 'Other' ? `<input type="text" id="${question.id}-other" class="mt-2 form-input w-full hidden" placeholder="Please specify">` : ''}
                        </div>
                    `).join('');
                case 'checkbox':
                    return question.options.map(option => `
                        <div class="mb-2">
                            <label class="inline-flex items-center">
                                <input type="checkbox" name="${question.id}" value="${option}" class="form-checkbox">
                                <span class="ml-2">${option}</span>
                            </label>
                            ${option === 'Other' ? `<input type="text" id="${question.id}-other" class="mt-2 form-input w-full hidden" placeholder="Please specify">` : ''}
                        </div>
                    `).join('');
                case 'text':
                    return `<textarea id="${question.id}" class="form-textarea mt-1 block w-full" rows="3" placeholder="Enter your response here"></textarea>`;
                case 'yesno':
                    return `
                        <div class="mb-4">
                            <label class="inline-flex items-center mr-4">
                                <input type="radio" name="${question.id}" value="Yes" class="form-radio">
                                <span class="ml-2">Yes</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="${question.id}" value="No" class="form-radio">
                                <span class="ml-2">No</span>
                            </label>
                        </div>
                        <div id="follow-up-container" class="hidden">
                            ${question.followUpType === 'checkbox' ? question.options.map(option => `
                                <div class="mb-2">
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" name="${question.id}-followup" value="${option}" class="form-checkbox">
                                        <span class="ml-2">${option}</span>
                                    </label>
                                    ${option === 'Other' ? `<input type="text" id="${question.id}-other" class="mt-2 form-input w-full hidden" placeholder="Please specify">` : ''}
                                </div>
                            `).join('') : ''}
                            ${question.followUpType === 'text' ? `<textarea id="${question.id}-followup" class="form-textarea mt-1 block w-full" rows="3" placeholder="Enter your response here"></textarea>` : ''}
                        </div>
                    `;
                default:
                    return '';
            }
        }

        function updateNextButtonState() {
            if (currentQuestion === -1) {
                const name = document.getElementById('name').value.trim();
                const company = document.getElementById('company').value.trim();
                const email = document.getElementById('email').value.trim();
                const phone = document.getElementById('phone').value.trim();
                nextButton.disabled = !(name && company && email && phone);
            } else {
                const currentQuestionData = questions[currentQuestion];
                let isAnswered = false;

                if (currentQuestionData.type === 'radio') {
                    isAnswered = questionContainer.querySelector('input[type="radio"]:checked') !== null;
                } else if (currentQuestionData.type === 'checkbox') {
                    isAnswered = questionContainer.querySelector('input[type="checkbox"]:checked') !== null;
                } else if (currentQuestionData.type === 'text') {
                    isAnswered = questionContainer.querySelector('textarea').value.trim() !== '';
                } else if (currentQuestionData.type === 'yesno') {
                    const yesNoAnswer = questionContainer.querySelector('input[type="radio"]:checked');
                    if (yesNoAnswer) {
                        if (yesNoAnswer.value === 'No') {
                            isAnswered = true;
                        } else {
                            if (currentQuestionData.followUpType === 'checkbox') {
                                isAnswered = questionContainer.querySelector('input[type="checkbox"]:checked') !== null;
                            } else if (currentQuestionData.followUpType === 'text') {
                                isAnswered = questionContainer.querySelector('textarea').value.trim() !== '';
                            }
                        }
                    }
                }

                nextButton.disabled = !isAnswered;
            }
            nextButton.classList.toggle('opacity-50', nextButton.disabled);
            nextButton.classList.toggle('cursor-not-allowed', nextButton.disabled);
        }

        function updateProgressBar() {
            const progress = ((currentQuestion + 1) / (questions.length + 1)) * 100;
            document.getElementById('progress').style.width = `${progress}%`;
        }

        function saveAnswer() {
            if (currentQuestion === -1) {
                answers.customerInfo = {
                    name: document.getElementById('name').value.trim(),
                    company: document.getElementById('company').value.trim(),
                    email: document.getElementById('email').value.trim(),
                    phone: document.getElementById('phone').value.trim()
                };
            } else {
                const currentQuestionData = questions[currentQuestion];
                if (currentQuestionData.type === 'radio') {
                    const selectedOption = questionContainer.querySelector('input[type="radio"]:checked');
                    if (selectedOption) {
                        answers[currentQuestionData.id] = selectedOption.value;
                        if (selectedOption.value === 'Other') {
                            answers[`${currentQuestionData.id}Other`] = questionContainer.querySelector(`#${currentQuestionData.id}-other`).value;
                        }
                    }
                } else if (currentQuestionData.type === 'checkbox') {
                    const selectedOptions = Array.from(questionContainer.querySelectorAll('input[type="checkbox"]:checked')).map(option => option.value);
                    answers[currentQuestionData.id] = selectedOptions;
                    if (selectedOptions.includes('Other')) {
                        answers[`${currentQuestionData.id}Other`] = questionContainer.querySelector(`#${currentQuestionData.id}-other`).value;
                    }
                } else if (currentQuestionData.type === 'text') {
                    answers[currentQuestionData.id] = questionContainer.querySelector('textarea').value;
                } else if (currentQuestionData.type === 'yesno') {
                    const yesNoAnswer = questionContainer.querySelector('input[type="radio"]:checked');
                    if (yesNoAnswer) {
                        answers[currentQuestionData.id] = yesNoAnswer.value;
                        if (yesNoAnswer.value === 'Yes') {
                            if (currentQuestionData.followUpType === 'checkbox') {
                                const selectedOptions = Array.from(questionContainer.querySelectorAll('input[type="checkbox"]:checked')).map(option => option.value);
                                answers[`${currentQuestionData.id}Followup`] = selectedOptions;
                                if (selectedOptions.includes('Other')) {
                                    answers[`${currentQuestionData.id}Other`] = questionContainer.querySelector(`#${currentQuestionData.id}-other`).value;
                                }
                            } else if (currentQuestionData.followUpType === 'text') {
                                answers[`${currentQuestionData.id}Followup`] = questionContainer.querySelector(`#${currentQuestionData.id}-followup`).value;
                            }
                        }
                    }
                }
            }
        }

        function showLoadingScreen() {
            questionContainer.innerHTML = `
                <div class="flex items-center justify-center">
                    <div class="animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-red-500"></div>
                </div>
                <p class="text-center mt-4">Submitting your survey responses...</p>
            `;
            nextButton.style.display = 'none';
            doneButton.style.display = 'none';
            printButton.style.display = 'none';
        }

        function showResults(result) {
            try {
                const parsedResult = JSON.parse(result);
                const markdownContent = parsedResult.text || 'No content available';
                
                // Set progress bar to 100%
                progressBar.style.display = 'block';
                document.getElementById('progress').style.width = '100%';
                
                questionContainer.innerHTML = `
                    <h2 class="text-xl font-semibold mb-4">Survey Results</h2>
                    <div class="bg-gray-100 p-4 rounded overflow-x-auto markdown-content">${marked.parse(markdownContent)}</div>
                    <button id="try-again-btn" class="mt-4 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Try Again</button>
                `;
                document.getElementById('try-again-btn').addEventListener('click', resetSurvey);
                nextButton.style.display = 'none';
                doneButton.style.display = 'none';
                printButton.style.display = 'inline-block';
            } catch (error) {
                console.error('Error parsing result:', error);
                questionContainer.innerHTML = `
                    <h2 class="text-xl font-semibold mb-4">Survey Results</h2>
                    <div class="bg-gray-100 p-4 rounded overflow-x-auto markdown-content">Error parsing results. Please try again.</div>
                    <button id="try-again-btn" class="mt-4 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Try Again</button>
                `;
                document.getElementById('try-again-btn').addEventListener('click', resetSurvey);
                nextButton.style.display = 'none';
                doneButton.style.display = 'none';
                printButton.style.display = 'none';
            }
        }

        async function submitSurvey() {
            showLoadingScreen();
            try {
                const response = await fetch('https://api.ai.vfrazier.net/webhook/ai-eval', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(answers)
                });
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const result = await response.text();
                showResults(result);
            } catch (error) {
                console.error('Error submitting survey:', error);
                showResults(JSON.stringify({text: `## Error\n\nAn error occurred while submitting the survey. Please try again later.\n\nError details: ${error.message}`}));
            }
        }

        function resetSurvey() {
            currentQuestion = -1;
            Object.keys(answers).forEach(key => delete answers[key]);
            questionContainer.style.display = 'none';
            customerInfoDiv.style.display = 'block';
            progressBar.style.display = 'none';
            nextButton.style.display = 'block';
            doneButton.style.display = 'none';
            printButton.style.display = 'none';
            document.getElementById('progress').style.width = '0%';
            ['name', 'company', 'email', 'phone'].forEach(id => {
                document.getElementById(id).value = '';
            });
            updateNextButtonState();
        }

        nextButton.addEventListener('click', () => {
            saveAnswer();
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                if (currentQuestion === 0) {
                    customerInfoDiv.style.display = 'none';
                    questionContainer.style.display = 'block';
                    progressBar.style.display = 'block';
                }
                renderQuestion(questions[currentQuestion]);
                if (currentQuestion === questions.length - 1) {
                    nextButton.style.display = 'none';
                    doneButton.style.display = 'inline-block';
                }
            } else {
                submitSurvey();
            }
        });

        doneButton.addEventListener('click', () => {
            saveAnswer();
            submitSurvey();
        });

        printButton.addEventListener('click', () => {
            window.print();
        });

        // Start with customer info
        currentQuestion = -1;
        questionContainer.style.display = 'none';
        customerInfoDiv.style.display = 'block';
        progressBar.style.display = 'none';
        doneButton.style.display = 'none';
        printButton.style.display = 'none';

        // Add event listeners to customer info inputs
        ['name', 'company', 'email', 'phone'].forEach(id => {
            document.getElementById(id).addEventListener('input', updateNextButtonState);
        });

        updateNextButtonState();
    </script>
</body>
</html>
